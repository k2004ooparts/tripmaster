// TripMaster 일정 기능 + UX 애니메이션 포함 버전 (추가분만)

<script>
let travelPlans = JSON.parse(localStorage.getItem('travelPlans')) || [];

function createPlan() {
  const date = prompt('여행 날짜를 입력하세요 (예: 2025-05-01)');
  const title = prompt('일정 제목을 입력하세요 (예: 제주 힐링 여행)');
  if (date && title) {
    travelPlans.push({ date, title, places: [] });
    localStorage.setItem('travelPlans', JSON.stringify(travelPlans));
    alert('일정이 추가되었습니다!');
    displayPlans();
  }
}

function addToPlan(placeName) {
  if (travelPlans.length === 0) return alert('먼저 일정을 하나 만들어주세요!');
  const planTitles = travelPlans.map((p, i) => `${i + 1}. ${p.title} (${p.date})`).join('\n');
  const choice = prompt(`어느 일정에 추가할까요?\n${planTitles}`);
  const index = parseInt(choice) - 1;
  if (travelPlans[index]) {
    travelPlans[index].places.push(placeName);
    localStorage.setItem('travelPlans', JSON.stringify(travelPlans));
    displayPlans();
  }
}

function displayPlans() {
  const container = document.getElementById('plans');
  container.innerHTML = '<h3>📅 나의 여행 일정</h3>';
  travelPlans.forEach(p => {
    container.innerHTML += `<div class="plan-card" style="margin:1rem 0;padding:1rem;background:#fff;border-radius:15px;box-shadow:0 2px 10px rgba(0,0,0,0.1);animation:fadeIn 0.5s ease;">
      <strong>${p.date} - ${p.title}</strong><br/>
      ${p.places.length > 0 ? p.places.join(', ') : '추가된 여행지가 없습니다.'}
    </div>`;
  });
}

// 결과 추천시 대기 애니메이션 + 일정 추가 버튼 반영
function recommend() {
  const style = document.getElementById('style').value;
  const budget = document.getElementById('budget').value;
  if (style && budget) {
    document.getElementById('result').innerHTML = '<p>추천 중입니다... 잠시만 기다려주세요 🧭</p>';
    setTimeout(() => {
      const place = places[style][Math.floor(Math.random() * places[style].length)];
      document.getElementById('result').innerHTML = `
        <div style="animation:fadeInUp 0.6s ease;">
          <h2>${place.name}</h2>
          <img src="${place.image}" class="place-image" alt="${place.name}"/>
          <br/>
          <a href="${place.map}" target="_blank"><button>지도 보기</button></a>
          <button onclick="addToPlan('${place.name}')">일정에 추가</button>
        </div>
      `;
      showMission();
    }, 1200);
  } else {
    document.getElementById('result').textContent = '여행 스타일과 예산을 모두 입력해 주세요!';
  }
}

// 애니메이션
const style = document.createElement('style');
style.innerHTML = `
@keyframes fadeInUp {
  from { opacity: 0; transform: translateY(20px); }
  to { opacity: 1; transform: translateY(0); }
}
@keyframes fadeIn {
  from { opacity: 0; }
  to { opacity: 1; }
}`;
document.head.appendChild(style);

displayPlans();
</script>
<div id="plans"></div>
<button onclick="createPlan()">+ 새 일정 만들기</button>
